CREATE TABLE sale.customer(
    id SERIAL,
    name_customer VARCHAR(100) NOT NULL,
    phone VARCHAR(20) NULL,
    email VARCHAR(100) NULL,
	CONSTRAINT pk_customer PRIMARY KEY (id) 
);

INSERT INTO sale.customer (name_customer, phone, email) VALUES
('María González', '555-100-2001', 'maria.gonzalez@email.com'),
('Juan Pérez', '555-100-2002', 'juan.perez@email.com'),
('Laura Martínez', '555-100-2003', 'laura.martinez@email.com'),
('Carlos Rodríguez', '555-100-2004', 'carlos.rodriguez@email.com'),
('Ana Sánchez', '555-100-2005', 'ana.sanchez@email.com'),
('David López', '555-100-2006', 'david.lopez@email.com'),
('Sofía Ramírez', '555-100-2007', 'sofia.ramirez@email.com'),
('José García', '555-100-2008', 'jose.garcia@email.com'),
('Fernanda Hernández', '555-100-2009', 'fernanda.hernandez@email.com'),
('Miguel Torres', '555-100-2010', 'miguel.torres@email.com'),
('Adriana Flores', '555-100-2011', 'adriana.flores@email.com'),
('Jorge Vargas', '555-100-2012', 'jorge.vargas@email.com'),
('Patricia Castro', '555-100-2013', 'patricia.castro@email.com'),
('Ricardo Morales', '555-100-2014', 'ricardo.morales@email.com'),
('Gabriela Ortega', '555-100-2015', 'gabriela.ortega@email.com'),
('Francisco Mendoza', '555-100-2016', 'francisco.mendoza@email.com'),
('Daniela Ríos', '555-100-2017', 'daniela.rios@email.com'),
('Alejandro Silva', '555-100-2018', 'alejandro.silva@email.com'),
('Verónica Medina', '555-100-2019', 'veronica.medina@email.com'),
('Roberto Guzmán', '555-100-2020', 'roberto.guzman@email.com'),
('Claudia Romero', '555-100-2021', 'claudia.romero@email.com'),
('Arturo Herrera', '555-100-2022', 'arturo.herrera@email.com'),
('Isabel Luna', '555-100-2023', 'isabel.luna@email.com'),
('Manuel Cruz', '555-100-2024', 'manuel.cruz@email.com'),
('Lucía Reyes', '555-100-2025', 'lucia.reyes@email.com'),
('Raúl Aguilar', '555-100-2026', 'raul.aguilar@email.com'),
('Carmen Paredes', '555-100-2027', 'carmen.paredes@email.com'),
('Oscar Vega', '555-100-2028', 'oscar.vega@email.com'),
('Elena Bravo', '555-100-2029', 'elena.bravo@email.com'),
('Santiago Campos', '555-100-2030', 'santiago.campos@email.com'),
('Diana Rojas', '555-100-2031', 'diana.rojas@email.com'),
('Héctor Núñez', '555-100-2032', 'hector.nunez@email.com'),
('Beatriz Salazar', '555-100-2033', 'beatriz.salazar@email.com'),
('Felipe Miranda', '555-100-2034', 'felipe.miranda@email.com'),
('Natalia Cortés', '555-100-2035', 'natalia.cortes@email.com'),
('Enrique Vázquez', '555-100-2036', 'enrique.vazquez@email.com'),
('Valeria Soto', '555-100-2037', 'valeria.soto@email.com'),
('Gustavo Méndez', '555-100-2038', 'gustavo.mendez@email.com'),
('Olivia Cordero', '555-100-2039', 'olivia.cordero@email.com'),
('Rodrigo Navarro', '555-100-2040', 'rodrigo.navarro@email.com'),
('Ximena Valdez', '555-100-2041', 'ximena.valdez@email.com'),
('Eduardo Rangel', '555-100-2042', 'eduardo.rangel@email.com'),
('Mariana Espinoza', '555-100-2043', 'mariana.espinoza@email.com'),
('Gerardo Lugo', '555-100-2044', 'gerardo.lugo@email.com'),
('Paulina Mejía', '555-100-2045', 'paulina.mejia@email.com'),
('Salvador Delgado', '555-100-2046', 'salvador.delgado@email.com'),
('Renata Cervantes', '555-100-2047', 'renata.cervantes@email.com'),
('Javier Rosas', '555-100-2048', 'javier.rosas@email.com'),
('Daniela Tapia', '555-100-2049', 'daniela.tapia@email.com'),
('Alfonso Zamora', '555-100-2050', 'alfonso.zamora@email.com'),
('Andrea Villegas', '555-100-2051', 'andrea.villegas@email.com'),
('Leonardo Quiroz', '555-100-2052', 'leonardo.quiroz@email.com'),
('Ana Karen Peña', '555-100-2053', 'anakaren.pena@email.com'),
('Rafael Lozano', '555-100-2054', 'rafael.lozano@email.com'),
('Jimena Orozco', '555-100-2055', 'jimena.orozco@email.com'),
('Josué Carrillo', '555-100-2056', 'josue.carrillo@email.com'),
('Fabiola Galván', '555-100-2057', 'fabiola.galvan@email.com'),
('Diego Rosales', '555-100-2058', 'diego.rosales@email.com'),
('Liliana Peralta', '555-100-2059', 'liliana.peralta@email.com'),
('Guillermo Téllez', '555-100-2060', 'guillermo.tellez@email.com');

CREATE TABLE sale.sale_detail(
    id SERIAL,
    id_item INTEGER NOT NULL,
    price DECIMAL(10,2) NOT NULL CHECK (price > 0),
    quantity INTEGER NOT NULL CHECK (quantity > 0),
    discount DECIMAL(5,2) NULL DEFAULT 0,
	CONSTRAINT pk_sale_detail PRIMARY KEY (id), 
    CONSTRAINT fk_store_item FOREIGN KEY (id_item) REFERENCES store.item(id)
);
INSERT INTO sale.sale_detail (id_item, price, quantity, discount) VALUES
-- Primeros 20 registros (los que ya proporcionaste)
(1, 19.99, 2, 0.00),
(2, 29.99, 1, 5.00),
(3, 15.50, 3, 10.00),
(4, 45.00, 1, 0.00),
(5, 12.75, 5, 15.00),
(6, 89.99, 1, 20.00),
(7, 32.50, 2, 0.00),
(8, 22.40, 4, 5.00),
(9, 55.00, 1, 10.00),
(10, 18.30, 3, 0.00),
(11, 75.25, 1, 25.00),
(12, 42.00, 2, 0.00),
(13, 29.99, 1, 10.00),
(14, 36.75, 2, 5.00),
(15, 120.00, 1, 15.00),
(16, 8.99, 10, 0.00),
(17, 65.50, 1, 30.00),
(18, 24.30, 3, 0.00),
(19, 33.33, 2, 10.00),
(20, 47.80, 1, 0.00),

-- Registros 21 a 40
(1, 21.50, 3, 5.00),
(2, 31.99, 2, 0.00),
(3, 16.75, 1, 15.00),
(4, 48.00, 2, 10.00),
(5, 14.25, 4, 0.00),
(6, 95.00, 1, 25.00),
(7, 35.60, 3, 5.00),
(8, 25.20, 2, 0.00),
(9, 60.00, 1, 20.00),
(10, 20.10, 4, 0.00),
(11, 80.00, 1, 30.00),
(12, 45.50, 3, 10.00),
(13, 32.99, 2, 5.00),
(14, 40.25, 1, 0.00),
(15, 125.50, 1, 15.00),
(16, 9.50, 8, 0.00),
(17, 70.00, 1, 35.00),
(18, 26.40, 2, 10.00),
(19, 35.00, 3, 0.00),
(20, 50.20, 1, 5.00),

-- Registros 41 a 60
(1, 22.99, 4, 10.00),
(2, 34.50, 1, 0.00),
(3, 18.25, 2, 20.00),
(4, 50.00, 3, 5.00),
(5, 15.99, 2, 0.00),
(6, 99.99, 1, 30.00),
(7, 38.75, 1, 10.00),
(8, 28.00, 3, 0.00),
(9, 65.50, 1, 25.00),
(10, 22.40, 2, 5.00),
(11, 85.25, 1, 35.00),
(12, 48.99, 1, 15.00),
(13, 35.60, 3, 0.00),
(14, 42.50, 2, 10.00),
(15, 130.00, 1, 20.00),
(16, 10.25, 5, 0.00),
(17, 72.50, 1, 40.00),
(18, 27.90, 4, 5.00),
(19, 36.66, 2, 15.00),
(20, 52.75, 1, 0.00);


CREATE TABLE sale.sale(
    id SERIAL,
    id_customer INTEGER NULL,
    id_user INTEGER NOT NULL,
    id_sale_detail INTEGER NOT NULL,
    date_sale TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    total DECIMAL(12,2) NOT NULL CHECK (total >= 0),
    payment_method VARCHAR(20) NULL,
	CONSTRAINT pk_sale PRIMARY KEY (id), 
    CONSTRAINT fk_sale_customer FOREIGN KEY (id_customer) REFERENCES sale.customer(id),
	RAINT fk_usuari_user FOREIGN KEY (id_user) REFERENCES usuari.user(id),
    CONSTRAINT fk_sale_sale_detail FOREIGN KEY (id_sale_detail) REFERENCES sale.sale_detail(id)
);
-- Índice para filtrar ventas por mes  
CREATE INDEX idx_sale_date_month ON sale.sale(EXTRACT(MONTH FROM date_sale));  
INSERT INTO sale.sale (id_customer, id_user, id_sale_detail, date_sale, total, payment_method) VALUES
-- Primeros 20 registros
(1, 3, 1, '2025-01-15 09:30:45', 39.98, 'Credit Card'),
(2, 2, 2, '2025-01-16 10:15:22', 29.99, 'Cash'),
(3, 4, 3, '2025-01-17 11:05:33', 46.50, 'Debit Card'),
(4, 2, 4, '2025-01-18 14:22:10', 45.00, 'Credit Card'),
(5, 3, 5, '2025-01-19 16:45:00', 63.75, 'Bank Transfer'),
(6, 5, 6, '2025-01-20 12:30:15', 89.99, 'Cash'),
(7, 4, 7, '2025-01-21 13:10:45', 65.00, 'Debit Card'),
(8, 2, 8, '2025-01-22 15:20:30', 89.60, 'Credit Card'),
(9, 3, 9, '2025-01-23 17:00:00', 55.00, 'Cash'),
(10, 3, 10, '2025-01-24 10:45:12', 54.90, 'Credit Card'),
(11, 5, 11, '2025-01-25 11:30:33', 75.25, 'Debit Card'),
(12, 4, 12, '2025-01-26 09:15:44', 84.00, 'Bank Transfer'),
(13, 2, 13, '2025-01-27 14:40:22', 29.99, 'Cash'),
(14, 3, 14, '2025-01-28 16:25:10', 73.50, 'Credit Card'),
(15, 5, 15, '2025-01-29 12:10:05', 120.00, 'Debit Card'),
(1, 2, 16, '2025-01-30 13:50:30', 89.90, 'Cash'),
(2, 4, 17, '2025-01-31 10:35:18', 65.50, 'Credit Card'),
(3, 3, 18, '2025-02-01 15:15:45', 72.90, 'Bank Transfer'),
(4, 5, 19, '2025-02-02 11:20:22', 66.66, 'Debit Card'),
(5, 2, 20, '2025-02-03 14:10:33', 47.80, 'Cash'),

-- Registros 21 a 40
(6, 3, 21, '2025-02-04 09:45:10', 64.50, 'Credit Card'),
(7, 4, 22, '2025-02-05 16:30:00', 63.98, 'Cash'),
(8, 2, 23, '2025-02-06 12:15:45', 50.25, 'Debit Card'),
(9, 5, 24, '2025-02-07 14:50:22', 96.00, 'Credit Card'),
(10, 3, 25, '2025-02-08 10:40:33', 60.30, 'Bank Transfer'),
(11, 4, 26, '2025-02-09 13:25:10', 240.00, 'Cash'),
(12, 2, 27, '2025-02-10 15:10:45', 85.50, 'Credit Card'),
(13, 3, 28, '2025-02-11 11:55:22', 70.00, 'Debit Card'),
(14, 5, 29, '2025-02-12 14:30:33', 72.60, 'Cash'),
(15, 4, 30, '2025-02-13 09:20:10', 105.00, 'Credit Card'),
(1, 3, 31, '2025-02-14 16:15:45', 91.96, 'Bank Transfer'),
(2, 2, 32, '2025-02-15 12:40:22', 34.50, 'Debit Card'),
(3, 5, 33, '2025-02-16 10:25:33', 36.50, 'Cash'),
(4, 3, 34, '2025-02-17 14:10:10', 150.00, 'Credit Card'),
(5, 4, 35, '2025-02-18 11:45:45', 31.98, 'Cash'),
(6, 2, 36, '2025-02-19 15:30:22', 99.99, 'Debit Card'),
(7, 3, 37, '2025-02-20 13:15:33', 38.75, 'Credit Card'),
(8, 5, 38, '2025-02-21 09:50:10', 84.00, 'Bank Transfer'),
(9, 4, 39, '2025-02-22 16:35:45', 65.50, 'Cash'),
(10, 2, 40, '2025-02-23 12:20:22', 44.80, 'Debit Card'),

-- Registros 41 a 60
(11, 3, 41, '2025-02-24 14:05:33', 85.25, 'Credit Card'),
(12, 5, 42, '2025-02-25 10:50:10', 48.99, 'Cash'),
(13, 4, 43, '2025-02-26 13:35:45', 106.80, 'Debit Card'),
(14, 2, 44, '2025-02-27 15:20:22', 85.00, 'Credit Card'),
(15, 3, 45, '2025-02-28 11:05:33', 130.00, 'Bank Transfer'),
(1, 5, 46, '2025-03-01 14:50:10', 51.25, 'Cash'),
(2, 4, 47, '2025-03-02 09:35:45', 72.50, 'Debit Card'),
(3, 2, 48, '2025-03-03 16:20:22', 111.60, 'Credit Card'),
(4, 3, 49, '2025-03-04 12:05:33', 73.32, 'Cash'),
(5, 5, 50, '2025-03-05 14:50:10', 52.75, 'Bank Transfer'),
(6, 4, 51, '2025-03-06 10:35:45', 114.95, 'Debit Card'),
(7, 2, 52, '2025-03-07 13:20:22', 69.00, 'Credit Card'),
(8, 3, 53, '2025-03-08 15:05:33', 54.75, 'Cash'),
(9, 5, 54, '2025-03-09 11:50:10', 180.00, 'Credit Card'),
(10, 4, 55, '2025-03-10 14:35:45', 63.96, 'Debit Card'),
(11, 2, 56, '2025-03-11 09:20:22', 199.98, 'Bank Transfer'),
(12, 3, 57, '2025-03-12 16:05:33', 77.50, 'Cash'),
(13, 5, 58, '2025-03-13 12:50:10', 168.00, 'Credit Card'),
(14, 4, 59, '2025-03-14 10:35:45', 130.50, 'Debit Card'),
(15, 2, 60, '2025-03-15 13:20:22', 260.00, 'Credit Card');